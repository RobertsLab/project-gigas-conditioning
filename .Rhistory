sum3 <- summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
hist(residuals(model3))
bptest(model3)
# p = 0.03978
## Successful model!
model3 <- lm(sqrt(width.mm)~length.mm+date_numeric, growth)
summary(model3)
sum3 <- summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
hist(residuals(model3))
bptest(model3)
# p = 0.03978
model2 <- lm(log10(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
qqPlot(model2)
bptest(model2)
model2 <- lm(log10(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
model2 <- lm(sqrt(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
model2 <- lm(sqrt(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
summary(wls_model2)
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
summary(wls_model2)
#view summary of model
summary(wls_model)
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
summary(wls_model2)
bptest(wls_model2)
summary(wls_model2)
summary(model2)
## Successful model!
model3 <- lm(sqrt(width.mm)~length.mm+date_numeric, growth)
summary(model3)
sum3 <- summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
hist(residuals(model3))
bptest(model3)
# p = 0.03978
wt <- 1 / lm(abs(model3$residuals) ~ model3$fitted.values)$fitted.values^2
wls_model3 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
summary(wls_model3)
bptest(wls_model3)
wt <- 1 / lm(abs(model3$residuals) ~ model3$fitted.values)$fitted.values^2
wls_model3 <- lm(sqrt(width.mm)~ length.mm+date_numeric, growth, weights=wt)
summary(wls_model3)
bptest(wls_model3)
summary(model3)
summary(wls_model3)
hist(residuals(wls_model3))
qqPlot(wls_model3)
qqPlot(wls_model2)
day1 <- subset(growth, date_numeric == 19884)
View(day1)
ggplot(day1, aes(x=length.mm, y= width.mm))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Width")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
library(readxl)
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(lmtest)
library(readxl)
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(lmtest)
library(car)
ggplot(day1, aes(x=length.mm, y= width.mm))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Width")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
ggplot(day1, aes(x=length.mm, y= height.mm))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Width")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
model4 <- lm(sqrt(width.mm)~length.mm, day1)
summary(model4)
plot(fitted(model4), residuals(model4),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model4)
hist(residuals(model4))
bptest(model4)
model4 <- lm((width.mm)~length.mm, day1)
summary(model4)
plot(fitted(model4), residuals(model4),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model4)
hist(residuals(model4))
bptest(model4)
model4 <- lm(sqrt(width.mm)~length.mm, day1)
summary(model4)
plot(fitted(model4), residuals(model4),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model4)
hist(residuals(model4))
bptest(model4)
model5 <- lm(height.mm~length.mm, day1)
summary(model5)
plot(fitted(model5), residuals(model5),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model5)
hist(residuals(model5))
bptest(model5)
model5 <- lm(log(height.mm)~length.mm, day1)
summary(model5)
plot(fitted(model5), residuals(model5),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model5)
hist(residuals(model5))
bptest(model5)
summary(model4)
plot(model2, which=2)
model2 <- lm(height.mm~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model2)
hist(residuals(model2))
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model2)
hist(residuals(model2))
## Successful model!
model3 <- lm(sqrt(width.mm)~length.mm+date_numeric, growth)
summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
hist(residuals(model3))
bptest(model3)
# p = 0.03978
#made data more heteroskedastic somehow
# wt <- 1 / lm(abs(model3$residuals) ~ model3$fitted.values)$fitted.values^2
# wls_model3 <- lm(sqrt(width.mm)~ length.mm+date_numeric, growth, weights=wt)
# summary(wls_model3)
## Successful model!
model3 <- lm(width.mm~length.mm+date_numeric, growth)
summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
## Successful model!
model3 <- lm(sqrt(width.mm)~length.mm+date_numeric, growth)
summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
hist(residuals(model3))
bptest(model3)
ols_test_breusch_pagan(model2)
growth$volume <- (4/3) * pi * (growth$length.mm/2) * (growth$width.mm/2) * (growth$height.mm/2)
model <- lmer(volume ~  effort/conditioning + date_numeric + (1 | bag_num/tag_num), data = growth)
library(lmertest)
library(lmerTest)
install.packages("lmerTest")
library(lmerTest)
model <- lmer(volume ~  effort/conditioning + date_numeric + (1 | bag_num/tag_num), data = growth)
summary(model)
anova(model)
data<-read_csv(file="data/outplanting/GoosePoint/growth_GoosePoint.csv")
View(data)
model <- lmer(volume ~  effort/conditioning + (1 | date_numeric/bag_num/tag_num), data = growth)
summary(model)
model <- lmer(volume ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
qqPlot(residuals(model))
hist(residuals(model))
model <- lmer(sqrt(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
anova(model)
qqPlot(residuals(model))
hist(residuals(model))
model <- lmer(sqrt(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
anova(model)
qqPlot(residuals(model))
hist(residuals(model))
model <- lmer(sqrt(volume) ~  effort/conditioning + bag_num (1 | date_numeric), data = growth)
model <- lmer(sqrt(volume) ~  effort/conditioning + bag_num +(1 | date_numeric), data = growth)
summary(model)
model <- lmer(sqrt(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
anova(model)
summary(model)
gsub("weekly", "treated", growth$conditioning)
gsub("daily", "treated", growth$conditioning)
growth <- gsub("weekly", "treated", growth$conditioning)
growth <- rbind(B_growth,D_growth)
growth$conditioning <- gsub("weekly", "treated", growth$conditioning)
growth$conditioning <- gsub("daily", "treated", growth$conditioning)
model <- lmer(sqrt(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
growth$volume <- (4/3) * pi * (growth$length.mm/2) * (growth$width.mm/2) * (growth$height.mm/2)
model <- lmer(sqrt(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
growth$date_numeric <- as.numeric(as.Date(growth$date))
model <- lmer(sqrt(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
qqPlot(residuals(model))
hist(residuals(model))
qqPlot(residuals(model))
plot(residuals(model), fitted(model))
plot(fitted(model), residuals(model))
model <- lmer(log(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
anova(model)
qqPlot(residuals(model))
plot(fitted(model), residuals(model))
plot(fitted(model), residuals(model))
abline(h = 0, col = "red")
bptest(model)
bptest(model)
qqPlot(residuals(model))
plot(fitted(model), residuals(model))
abline(h = 0, col = "red")
library(readxl)
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(lmtest)
library(car)
install.packages("lmerTest")
library(lmerTest)
# B survival
B_growth <- read_xlsx("/Users/graceleuchtenberger/Library/Mobile Documents/com~apple~CloudDocs/Documents/project-gigas-conditioning-GL/data/sizes/B_2023POGS_small_seed_daily/B_sizes_09132024.xlsx")
# Heights from bag 2 for 07/05/2024 showing up as NAs for some reason when data imported
B_growth$length.mm <- as.numeric(B_growth$length.mm)
B_growth$width.mm <- as.numeric(B_growth$width.mm)
B_growth$height.mm <- as.numeric(B_growth$height.mm)
B_growth$date <- as.Date(B_growth$date)
B_growth <- B_growth %>% drop_na(length.mm, width.mm, height.mm)
# D survival
D_growth <- read_xlsx("/Users/graceleuchtenberger/Library/Mobile Documents/com~apple~CloudDocs/Documents/project-gigas-conditioning-GL/data/sizes/D_2023POGS_small_seed_weekly/D_sizes_09132024.xlsx")
D_growth <- D_growth %>% drop_na(length.mm, width.mm, height.mm)
D_growth$date <- as.Date(D_growth$date)
# Removing an outlier, I think it was an incorrect measurement
D_growth <- D_growth[D_growth$width.mm != 82, ]
# Removing an outlier, I think it was an incorrect measurement
D_growth <- D_growth[D_growth$width.mm != 82, ]
growth <- rbind(B_growth,D_growth)
ggplot(growth, aes(x=length.mm, y= height.mm))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Width")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
ggplot(growth, aes(x=length.mm, y= height.mm))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Height")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
ggplot(growth, aes(x=length.mm, y= log(height.mm)))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Width")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
ggplot(growth, aes(x=length.mm, y= sqrt(width.mm)))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Width")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
## Successful model!
model3 <- lm(sqrt(width.mm)~length.mm+date_numeric, growth)
growth <- rbind(B_growth,D_growth)
growth_noNT <- growth[growth$tag_num != "NT", ]
growth_noNT$date_numeric <-  as.numeric(as.Date(growth_noNT$date))
growth$date_numeric <- as.numeric(as.Date(growth$date))
## Successful model!
model3 <- lm(sqrt(width.mm)~length.mm+date_numeric, growth)
summary(model3)
plot(fitted(model3), residuals(model3),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
qqPlot(model3)
hist(residuals(model3))
bptest(model3)
# p = 0.03978
#made data more heteroskedastic somehow
# wt <- 1 / lm(abs(model3$residuals) ~ model3$fitted.values)$fitted.values^2
# wls_model3 <- lm(sqrt(width.mm)~ length.mm+date_numeric, growth, weights=wt)
# summary(wls_model3)
ggplot(growth, aes(x=length.mm, y= log(height.mm)))+
geom_point()+
theme_classic()+
labs(x = "Length", y = "Height")+
theme(axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
axis.text = element_text(size = 20))
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
# weighted model does not provide a better fit than first model (standard error increased, not much change in R squared)
# wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
# wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
# summary(wls_model2)
# bptest(wls_model2)
model2 <- lm(sqrt(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
# weighted model does not provide a better fit than first model (standard error increased, not much change in R squared)
# wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
# wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
# summary(wls_model2)
# bptest(wls_model2)
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
# weighted model does not provide a better fit than first model (standard error increased, not much change in R squared)
# wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
# wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
# summary(wls_model2)
# bptest(wls_model2)
model2 <- lm(log(height.mm)~length.mm+date_numeric, growth)
summary(model2)
plot(fitted(model2), residuals(model2),
xlab = "Fitted Values",
ylab = "Residuals",
main = "Residuals vs Fitted")
abline(h = 0, col = "red")
library(car)
qqPlot(model2)
hist(residuals(model2))
bptest(model2)
# weighted model does not provide a better fit than first model (standard error increased, not much change in R squared)
# wt <- 1 / lm(abs(model2$residuals) ~ model2$fitted.values)$fitted.values^2
# wls_model2 <- lm( log(height.mm)~ length.mm+date_numeric, growth, weights=wt)
# summary(wls_model2)
# bptest(wls_model2)
model <- lmer(log(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
growth$volume <- (4/3) * pi * (growth$length.mm/2) * (growth$width.mm/2) * (growth$height.mm/2)
growth$conditioning <- gsub("weekly", "treated", growth$conditioning)
growth$conditioning <- gsub("daily", "treated", growth$conditioning)
model <- lmer(log(volume) ~  effort/conditioning + (1 | date_numeric/bag_num), data = growth)
summary(model)
anova(model)
qqPlot(residuals(model))
plot(fitted(model), residuals(model))
abline(h = 0, col = "red")
