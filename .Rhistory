library(glmmTMB)#follows lme4 syntax
install.packages("glmmTMB")
library(glmmTMB)#follows lme4 syntax
install.packages("DHARMa")
library(DHARMa)
means_vols$bag_num <- as.factor(means_vols$bag_num)
model <- lmer(perc_change_vol ~  effort/conditioning * date + (1 | bag_num), data = means_vols)
summary(model)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols,family=gaussian()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols,family=gaussian())
vignette("troubleshooting")
vignette("glmmTMB"::"troubleshooting")
summary(model.m)
fixef(zinbm0)
fixef(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols) #glmmTMB
summary(model.m)
hist(means_vols$perc_change_vol)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = Gamma) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = ziGamma) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = ziGamma()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
means_vols$perc_change_vol <- gsub(0, 0.1, means_vols$perc_change_vol)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
means_vols <- growth %>%
group_by(effort, conditioning, date, bag_num) %>%
summarise(mean_vol = mean(volume),
std_error = sd(volume)/sqrt(length(volume)),
.groups = 'drop')
means_vols <- means_vols %>%
group_by(bag_num) %>%
mutate(initial_vol = first(mean_vol)) %>%
ungroup()
means_vols <- means_vols %>%
mutate(perc_change_vol = 100*(mean_vol-initial_vol)/initial_vol )
means_vols$date <- as.POSIXct(means_vols$date)
means_vols$bag_num <- as.factor(means_vols$bag_num)
hist(means_vols$perc_change_vol)
means_vols$perc_change_vol <- gsub(0.0000, 0.1, means_vols$perc_change_vol)
means_vols <- growth %>%
group_by(effort, conditioning, date, bag_num) %>%
summarise(mean_vol = mean(volume),
std_error = sd(volume)/sqrt(length(volume)),
.groups = 'drop')
means_vols <- means_vols %>%
group_by(bag_num) %>%
mutate(initial_vol = first(mean_vol)) %>%
ungroup()
means_vols <- means_vols %>%
mutate(perc_change_vol = 100*(mean_vol-initial_vol)/initial_vol )
means_vols <- means_vols %>%
mutate(perc_change_vol = ifelse(date == "2024-06-10", 0.1,perc_change_vol ))
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
hist(means_vols$perc_change_vol)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = ziGamma()) #glmmTMB
means_vols <- means_vols %>%
mutate(perc_change_vol = ifelse(date == "2024-06-10", 1,perc_change_vol ))
hist(means_vols$perc_change_vol)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = ziGamma()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = gaussian()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
any(means_vols$perc_change_vol <= 0)
summary(means_vols)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + date + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + (1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
str(means_vols$date)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + date +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
plot(means_vols$date, means_vols$perc_change_vol)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning * date +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning * date +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning * date +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning * date +(1 | bag_num),data = means_vols, family = gaussian()) #glmmTMB
f
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date_numeric, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
tst_simres <- simulateResiduals(model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
tst_simres <- simulateResiduals(model.m) #DHARMa
plot(tst_simres)
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
tst_simres <- simulateResiduals(model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
install.packages("splines")
library(splines)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,4) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning * date +(1 | bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3) +(1 | bag_num),data = means_vols, family = gaussian()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
tst_simres <- simulateResiduals(model.m) #DHARMa
plot(tst_simres)
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,4) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
tst_simres <- simulateResiduals(model.m) #DHARMa
plot(tst_simres)
testDispersion(model.m)
residuals(tst_simres)
plot(tst_simres)
tst_simres <- simulateResiduals(model.m, refit = T) #DHARMa
tst_simres <- simulateResiduals(model.m, refit = TRUE) #DHARMa
tst_simres <- simulateResiduals(fittedModel = model.m, refit = TRUE) #DHARMa
tst_simres <- simulateResiduals(fittedModel = model.m, refit = T) #DHARMa
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date, 2) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
testTemporalAutocorrelation(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * date +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3) +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning +(1 | bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + date,data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date, 2),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + (date|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + date+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,2)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,4)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,2)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + ns(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
summary(model.m)
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,3)+ (1|bag_num),data = means_vols, family = lognormal()) #glmmTMB
summary(model.m)
summary(model.m)
testDispersion(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
plotResiduals(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning + poly(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
plotResiduals(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,2)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * ns(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning * poly(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model <- lmer(perc_change_vol ~  effort/conditioning + date + (1 | bag_num), data = means_vols)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning +date+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *ns(date)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *ns(date,2)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *ns(date,3)+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
plot(means_vols$date, means_vols$perc_change_vol)
summary(model.m)
library(ggplot2)
means_vols$predicted <- predict(model.m, type = "response")
ggplot(means_vols, aes(x = date, y = perc_change_vol)) +
geom_point() +
geom_line(aes(y = predicted), color = "blue")
ggplot(means_vols, aes(x = date, y = log(perc_change_vol))) +
geom_point() +
geom_line(aes(y = predicted), color = "blue")
ggplot(means_vols, aes(x = date, y = log(perc_change_vol))) +
geom_point()
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = Gamma(link = "log")) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian(link = log)) #glmmTMB
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian(link = log)) #glmmTMB
model <- lmer(log(perc_change_vol) ~  effort/conditioning + date + (1 | bag_num), data = means_vols)
summary(model)
model <- lmer(log(perc_change_vol) ~  effort/conditioning * date + (1 | bag_num), data = means_vols)
model <- lmer(log(perc_change_vol) ~  effort/conditioning +date + (1 | bag_num), data = means_vols)
summary(model)
model <- lmer(log(perc_change_vol) ~  effort/conditioning +(1 | bag_num), data = means_vols)
summary(model)
model <- lmer(log(perc_change_vol) ~  effort/conditioning *date , data = means_vols)
model <- lmer(log(perc_change_vol) ~  effort/conditioning *date + (1|bag_num), data = means_vols)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian(link = log)) #glmmTMB
summary(model.m)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian(link = log)) #glmmTMB
hist(log(means_vols$perc_change_vol))
means_vols <- subset(means_vols, date != "2024-06-10")
hist(means_vols$perc_change_vol)
hist(log(means_vols$perc_change_vol))
plot(means_vols$date, means_vols$perc_change_vol)
plot(means_vols$date, log(means_vols$perc_change_vol))
hist(means_vols$perc_change_vol)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (bag_num|bag_num),data = means_vols, family = gaussian()) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *date + (1|bag_num), data = means_vols)
summary(model.b)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *date + (1|bag_num), data = means_vols)
summary(model.b)
qqPlot(model.b)
car::qqPlot(model.b)
car::qqPlot(residuals(model.b))
qqnorm(resid(model.b))
qqline(resid(model.b))
means_vols$date <- as.POSIXct(means_vols$date)
means_vols$bag_num <- as.factor(means_vols$bag_num)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *date + (1|bag_num), data = means_vols)
range(means_vols$date)
means_vols <- growth %>%
group_by(effort, conditioning, date, bag_num) %>%
summarise(mean_vol = mean(volume),
std_error = sd(volume)/sqrt(length(volume)),
.groups = 'drop')
means_vols <- means_vols %>%
group_by(bag_num) %>%
mutate(initial_vol = first(mean_vol)) %>%
ungroup()
means_vols <- means_vols %>%
mutate(perc_change_vol = 100*(mean_vol-initial_vol)/initial_vol )
means_vols$days <- as.numeric(means_vols$date - min(means_vols$date))
hist(means_vols$perc_change_vol)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
means_vols <- subset(means_vols, date != "2024-06-10")
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *date+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *date + (1|bag_num), data = means_vols)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *days + (1|bag_num), data = means_vols)
summary(model.b)
qqnorm(resid(model.b))
qqline(resid(model.b))
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning +days + (1|bag_num), data = means_vols)
summary(model.b)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *days + (1|bag_num), data = means_vols)
summary(model.b)
qqnorm(resid(model.b))
qqline(resid(model.b))
qqPlot(model.b)
qqnorm(resid(model.b))
qqline(resid(model.b))
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian())
summary(model.m)
model.b<- lmer(log(perc_change_vol) ~  effort/conditioning *days + (1|bag_num), data = means_vols)
summary(model.b)
summary(model.m)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning +days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
hist(residuals(model.m))
qqPlot(model.m)
qqPlot(residuals(model.m))
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(sqrt(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.m<-glmmTMB(sqrt(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
means_vols$predicted <- predict(model.m, type = "response")
ggplot(means_vols, aes(x = date, y = perc_change_vol)) +
geom_point() +
geom_line(aes(y = predicted), color = "blue")
means_vols$predicted <- predict(model.m, type = "response")
ggplot(means_vols, aes(x = days, y = perc_change_vol)) +
geom_point() +
geom_line(aes(y = predicted), color = "blue")
ggplot(means_vols, aes(x = days, y = sqrt*(perc_change_vol))) +
geom_point() +
geom_line(aes(y = predicted), color = "blue")
ggplot(means_vols, aes(x = days, y = sqrt(perc_change_vol))) +
geom_point() +
geom_line(aes(y = predicted), color = "blue")
ggplot(means_vols, aes(x = days, y = predicted)) +
geom_line()
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
ggplot(means_vols, aes(x = days, y = predicted)) +
geom_line()
means_vols$predicted <- predict(model.m, type = "response")
ggplot(means_vols, aes(x = days, y = predicted)) +
geom_line()
model.m<-glmmTMB(perc_change_vol ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
model.m<-glmmTMB(log(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
model.m<-glmmTMB(sqrt(perc_change_vol) ~  effort/conditioning *days+ (1|bag_num),data = means_vols, family = gaussian()) #glmmTMB
summary(model.m)
testDispersion(model.m)
tst_simres <- simulateResiduals(fittedModel = model.m) #DHARMa
plot(tst_simres)
model.b<- lmer(sqrt(perc_change_vol) ~  effort/conditioning *days + (1|bag_num), data = means_vols)
summary(model.b)
qqnorm(resid(model.b))
qqline(resid(model.b))
model.b<- lmer(sqrt(perc_change_vol) ~  effort/conditioning *days + (1|bag_num), data = means_vols)
summary(model.b)
qqnorm(resid(model.b))
qqline(resid(model.b))
summary(model.m)
hist(means_vols$perc_change_vol)
hist(log(means_vols$perc_change_vol))
hist(sqrt(means_vols$perc_change_vol))
hist(log(means_vols$perc_change_vol))
hist(sqrt(means_vols$perc_change_vol))
hist(means_vols$perc_change_vol)
hist(log(means_vols$perc_change_vol))
hist(sqrt(means_vols$perc_change_vol))
anova(model.m)
car::Anova(model.m)
summary(model.m)
car::Anova(model.m)
summary(model.m)
car::Anova(model.m)
car::Anova(model.m, type = "III")
summary(model.m)
emm_combined <- emmeans(model.m, ~ effort | conditioning + days)
library(emmeans)
install.packages("emmeans")
library(emmeans)
emm_combined <- emmeans(model.m, ~ effort | conditioning + days)
emm_combined
emm_interaction <- emmeans(model.m, ~ effort | conditioning)
emm_interaction
emm_interaction <- emmeans(model.m, ~ effort | conditioning)
emm_interaction
emm_interaction <- emmeans(model.m, ~ effort * conditioning | days)
emm_interaction
pairs(emm_effort)
pairs(emm_interaction)
# Pairwise comparisons for interaction
pairs(emm_interaction, by = "days")  # Compare effort * conditioning combinations within days
# Pairwise comparisons for interaction
pairs(emm_interaction, by = "days")  # Compare effort * conditioning combinations within days
